{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/14698/Documents/Courses/CC/RetailApp/front-end/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/14698/Documents/Courses/CC/RetailApp/front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/14698/Documents/Courses/CC/RetailApp/front-end/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";// import { makeStyles } from '@material-ui/core/styles';\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _require=require(\"../utils/Backend_API\"),Backend_API=_require.Backend_API;// const useStyles = makeStyles((theme) => ({\n//   root: {\n//     display: 'flex',\n//     '& > * + *': {\n//       marginLeft: theme.spacing(2),\n//     },\n//   },\n// }));\n// export default function CircularIndeterminate() {\n//   const classes = useStyles();\n//   return (\n//     <div className={classes.root}>\n//       <CircularProgress />\n//       <CircularProgress color=\"secondary\" />\n//     </div>\n//   );\n// }\nvar Page4=function Page4(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),dataSetName=_useState2[0],setDataSetName=_useState2[1];var userName=sessionStorage.getItem(\"user_auth_token\");var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userDatasetList=_useState4[0],setUserDatasetList=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setLoading=_useState6[1];var history=useHistory();var handleFilesUpload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var transactionsFile,productsFile,householdsFile,file_data,_yield$fetch,status;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();//Prevents page reload\nif(!userDatasetList.includes(dataSetName)){_context.next=4;break;}alert(\"A data-set with that name exists!\");return _context.abrupt(\"return\");case 4:transactionsFile=document.getElementById(\"transactionsFile\").files;productsFile=document.getElementById(\"productsFile\").files;householdsFile=document.getElementById(\"householdsFile\").files;//Now prepare the file for transfer\nfile_data=new FormData();file_data.append(\"csvFiles\",transactionsFile[0]);file_data.append(\"csvFiles\",productsFile[0]);file_data.append(\"csvFiles\",householdsFile[0]);if(!(userName&&dataSetName)){_context.next=20;break;}setLoading(true);_context.next=15;return fetch(Backend_API+\"csvupload/\".concat(userName,\"/\").concat(dataSetName),{method:\"POST\",body:file_data});case 15:_yield$fetch=_context.sent;status=_yield$fetch.status;if(status===200){setLoading(false);console.log(\"Files inserted succesfully\");history.push(\"/home/page1\");}_context.next=23;break;case 20:setLoading(false);console.log(\"user Name invalid\");alert(\"An error occured\");case 23:case\"end\":return _context.stop();}}},_callee);}));return function handleFilesUpload(_x){return _ref.apply(this,arguments);};}();useEffect(function(){function getUserDataSetNames(){return _getUserDataSetNames.apply(this,arguments);}function _getUserDataSetNames(){_getUserDataSetNames=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,status,_yield$response$json,dataSetNames;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(Backend_API+\"fetchDataSetNames\",{headers:{\"Content-Type\":\"application/json\"},method:\"POST\",body:JSON.stringify({userName:userName})});case 2:response=_context2.sent;status=response.status;if(!(status===200)){_context2.next=10;break;}_context2.next=7;return response.json(response);case 7:_yield$response$json=_context2.sent;dataSetNames=_yield$response$json.dataSetNames;setUserDatasetList(dataSetNames);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return _getUserDataSetNames.apply(this,arguments);}getUserDataSetNames();},[]);return/*#__PURE__*/_jsx(\"div\",{id:\"mainContainer\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){return handleFilesUpload(e);},encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:dataSetName,onChange:function onChange(e){return setDataSetName(e.target.value);},className:\"form-control\",\"aria-describedby\":\"emailHelp\",placeholder:\"Enter Dataset Name\",required:true})}),/*#__PURE__*/_jsxs(\"table\",{style:{width:\"50%\",margin:\"50px auto\"},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Transactions\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Products\"}),/*#__PURE__*/_jsx(\"th\",{children:\"HouseHolds\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"transactionsFile\",name:\"csvFiles\",accept:\".csv\",required:true})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"productsFile\",name:\"csvFiles\",accept:\".csv\",required:true})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"householdsFile\",name:\"csvFiles\",accept:\".csv\",required:true})})]})})]})]}),isLoading&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Uploading data..\"})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Submit\"})]})});};export default Page4;","map":{"version":3,"sources":["C:/Users/14698/Documents/Courses/CC/RetailApp/front-end/src/components/Page4.js"],"names":["useState","useEffect","useHistory","require","Backend_API","Page4","props","dataSetName","setDataSetName","userName","sessionStorage","getItem","userDatasetList","setUserDatasetList","isLoading","setLoading","history","handleFilesUpload","e","preventDefault","includes","alert","transactionsFile","document","getElementById","files","productsFile","householdsFile","file_data","FormData","append","fetch","method","body","status","console","log","push","getUserDataSetNames","headers","JSON","stringify","response","json","dataSetNames","target","value","width","margin"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n// import { makeStyles } from '@material-ui/core/styles';\r\nconst { Backend_API } = require(\"../utils/Backend_API\");\r\n\r\n// const useStyles = makeStyles((theme) => ({\r\n//   root: {\r\n//     display: 'flex',\r\n//     '& > * + *': {\r\n//       marginLeft: theme.spacing(2),\r\n//     },\r\n//   },\r\n// }));\r\n\r\n// export default function CircularIndeterminate() {\r\n//   const classes = useStyles();\r\n\r\n//   return (\r\n//     <div className={classes.root}>\r\n//       <CircularProgress />\r\n//       <CircularProgress color=\"secondary\" />\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\nconst Page4 = (props) => {\r\n  const [dataSetName, setDataSetName] = useState(\"\");\r\n  const userName = sessionStorage.getItem(\"user_auth_token\");\r\n  const [userDatasetList, setUserDatasetList] = useState([]);\r\n  const [isLoading, setLoading] = useState(false);\r\n  const history = useHistory();\r\n\r\n  const handleFilesUpload = async (e) => {\r\n    e.preventDefault(); //Prevents page reload\r\n\r\n    if (userDatasetList.includes(dataSetName)) {\r\n      alert(\"A data-set with that name exists!\");\r\n      return;\r\n    }\r\n\r\n    let transactionsFile = document.getElementById(\"transactionsFile\").files;\r\n    let productsFile = document.getElementById(\"productsFile\").files;\r\n    let householdsFile = document.getElementById(\"householdsFile\").files;\r\n\r\n    //Now prepare the file for transfer\r\n    const file_data = new FormData();\r\n    file_data.append(\"csvFiles\", transactionsFile[0]);\r\n    file_data.append(\"csvFiles\", productsFile[0]);\r\n    file_data.append(\"csvFiles\", householdsFile[0]);\r\n\r\n    if (userName && dataSetName) {\r\n      setLoading(true);\r\n      const { status } = await fetch(\r\n        Backend_API + `csvupload/${userName}/${dataSetName}`,\r\n        {\r\n          method: \"POST\",\r\n          body: file_data,\r\n        }\r\n      );\r\n      if (status === 200) {\r\n        setLoading(false);\r\n\r\n        console.log(\"Files inserted succesfully\");\r\n        history.push(\"/home/page1\");\r\n      }\r\n    } else {\r\n      setLoading(false);\r\n      console.log(\"user Name invalid\");\r\n      alert(\"An error occured\");\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    async function getUserDataSetNames() {\r\n      //console.log(\"Fetching records of\", userName);\r\n      const response = await fetch(Backend_API + \"fetchDataSetNames\", {\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        method: \"POST\",\r\n        body: JSON.stringify({ userName }),\r\n      });\r\n      let { status } = response;\r\n      if (status === 200) {\r\n        const { dataSetNames } = await response.json(response);\r\n        setUserDatasetList(dataSetNames);\r\n      }\r\n    }\r\n    getUserDataSetNames();\r\n  }, []);\r\n  return (\r\n    <div id=\"mainContainer\">\r\n      <form\r\n        onSubmit={(e) => handleFilesUpload(e)}\r\n        encType=\"multipart/form-data\"\r\n      >\r\n        <div className=\"mb-3\">\r\n          <div className=\"form-group\">\r\n            <input\r\n              type=\"text\"\r\n              value={dataSetName}\r\n              onChange={(e) => setDataSetName(e.target.value)}\r\n              className=\"form-control\"\r\n              aria-describedby=\"emailHelp\"\r\n              placeholder=\"Enter Dataset Name\"\r\n              required\r\n            />\r\n          </div>\r\n          <table style={{ width: \"50%\", margin: \"50px auto\" }}>\r\n            <thead>\r\n              <tr>\r\n                <th>Transactions</th>\r\n                <th>Products</th>\r\n                <th>HouseHolds</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <input\r\n                    type=\"file\"\r\n                    id=\"transactionsFile\"\r\n                    name=\"csvFiles\"\r\n                    accept=\".csv\"\r\n                    required\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    type=\"file\"\r\n                    id=\"productsFile\"\r\n                    name=\"csvFiles\"\r\n                    accept=\".csv\"\r\n                    required\r\n                  />\r\n                </td>\r\n                <td>\r\n                  <input\r\n                    type=\"file\"\r\n                    id=\"householdsFile\"\r\n                    name=\"csvFiles\"\r\n                    accept=\".csv\"\r\n                    required\r\n                  />\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n       {(isLoading) && <div>\r\n        <p>Uploading data..</p>\r\n        </div>}\r\n        <button type=\"submit\" className=\"btn btn-primary\">\r\n          Submit\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Page4;\r\n"]},"metadata":{},"sourceType":"module"}